Inventory management is a critical aspect of Ansible, as it defines the hosts and groups of hosts on which Ansible will execute tasks. Ansible supports both **static** and **dynamic** inventory configurations. Below is an explanation of both, along with examples:

---

### **1. Static Inventory**
A static inventory is a simple text file (usually in INI or YAML format) that lists the hosts and groups of hosts. This is the default method for defining inventory in Ansible.

#### **INI Format Example**
```ini
# /etc/ansible/hosts (default inventory file)

# Define individual hosts
web1.example.com
web2.example.com

# Define groups of hosts
[webservers]
web1.example.com
web2.example.com

[dbservers]
db1.example.com
db2.example.com

# Define groups of groups
[allservers:children]
webservers
dbservers

# Define variables for hosts or groups
[webservers:vars]
ansible_user=admin
ansible_ssh_private_key_file=/path/to/key.pem

[dbservers:vars]
ansible_user=dbadmin
```

#### **YAML Format Example**
```yaml
# inventory.yml

all:
  hosts:
    web1.example.com:
    web2.example.com:
  children:
    webservers:
      hosts:
        web1.example.com:
        web2.example.com:
      vars:
        ansible_user: admin
        ansible_ssh_private_key_file: /path/to/key.pem
    dbservers:
      hosts:
        db1.example.com:
        db2.example.com:
      vars:
        ansible_user: dbadmin
```

#### **Using a Static Inventory**
- Specify the inventory file when running Ansible commands:
  ```bash
  ansible-playbook -i /path/to/inventory_file playbook.yml
  ```
- If no inventory file is specified, Ansible uses the default `/etc/ansible/hosts`.

---

### **2. Dynamic Inventory**
A dynamic inventory is a script or program that generates inventory data in real-time, typically by querying an external source like a cloud provider (AWS, Azure, GCP), a CMDB, or a database. Dynamic inventory scripts output JSON data that Ansible can parse.

#### **How Dynamic Inventory Works**
1. The inventory script is executed by Ansible.
2. The script outputs JSON data describing the hosts and groups.
3. Ansible uses this JSON data to build the inventory.

#### **Example: AWS EC2 Dynamic Inventory**
Ansible provides a built-in dynamic inventory script for AWS EC2 (`aws_ec2.py`).

1. Install the `boto3` library (required for the AWS EC2 script):
   ```bash
   pip install boto3
   ```
2. Download the AWS EC2 inventory script:
   ```bash
   wget https://raw.githubusercontent.com/ansible/ansible/devel/contrib/inventory/aws_ec2.py
   chmod +x aws_ec2.py
   ```
3. Configure AWS credentials (e.g., using `~/.aws/credentials` or environment variables).
4. Use the dynamic inventory script:
   ```bash
   ansible-inventory -i aws_ec2.py --list
   ```
5. Run a playbook using the dynamic inventory:
   ```bash
   ansible-playbook -i aws_ec2.py playbook.yml
   ```

#### **Custom Dynamic Inventory Script**
You can write your own dynamic inventory script in any programming language (e.g., Python, Bash). The script must output JSON in the following format:

```json
{
  "group1": {
    "hosts": ["host1.example.com", "host2.example.com"],
    "vars": {
      "ansible_user": "admin"
    }
  },
  "group2": {
    "hosts": ["host3.example.com"],
    "vars": {
      "ansible_user": "dbadmin"
    }
  }
}
```

#### **Example: Simple Python Dynamic Inventory Script**
```python
#!/usr/bin/env python3

import json

inventory = {
    "webservers": {
        "hosts": ["web1.example.com", "web2.example.com"],
        "vars": {
            "ansible_user": "admin"
        }
    },
    "dbservers": {
        "hosts": ["db1.example.com"],
        "vars": {
            "ansible_user": "dbadmin"
        }
    }
}

print(json.dumps(inventory))
```

- Save the script as `dynamic_inventory.py`.
- Make it executable:
  ```bash
  chmod +x dynamic_inventory.py
  ```
- Use it with Ansible:
  ```bash
  ansible-inventory -i dynamic_inventory.py --list
  ansible-playbook -i dynamic_inventory.py playbook.yml
  ```

---

### **Key Differences Between Static and Dynamic Inventory**
| **Feature**            | **Static Inventory**                          | **Dynamic Inventory**                        |
|-------------------------|-----------------------------------------------|---------------------------------------------|
| **Definition**          | Manually defined text file (INI/YAML).        | Generated by a script or program.           |
| **Use Case**            | Small, static environments.                   | Large, dynamic environments (e.g., cloud).  |
| **Maintenance**         | Manual updates required.                     | Automatically updated by the script.        |
| **Flexibility**         | Limited to predefined hosts/groups.           | Can adapt to changing infrastructure.       |
| **Performance**         | Faster for small inventories.                 | May have overhead for large inventories.    |

---

### **Best Practices for Inventory Management**
1. Use **static inventory** for small, stable environments.
2. Use **dynamic inventory** for cloud or highly dynamic environments.
3. Organize hosts into logical groups for better management.
4. Use inventory variables to customize behavior for specific hosts or groups.
5. Store sensitive data (e.g., passwords, keys) in Ansible Vault.

By leveraging both static and dynamic inventory configurations, you can effectively manage your infrastructure with Ansible, regardless of its size or complexity.
